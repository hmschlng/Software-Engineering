# 21-1 Embedded System Design
---

<br>

### ✅ Embedded system design (임베디드 시스템 설계)
<br>

- 임베디드 시스템의 설계 프로세스에서는 시스템 하드웨어의 설계와 성능을 상세히 고려해야 합니다.
<br>

- 설계 프로세스의 일부는 소프트웨어에 구현될 시스템 기능과 하드웨어에 구현될 시스템 기능을 결정하는 것을 포함할 수 있습니다.
<br>

- 하드웨어, 지원 소프트웨어 및 시스템 타이밍에 대한 저수준의 결정은 프로세스 초기에 고려되어야 합니다. 이는 배터리 및 전원 관리와 같은 추가 소프트웨어 기능을 시스템에 포함할 수 있다는 의미입니다.
<br>

### ✅ Reactive systems (반응형 시스템)
<br>

- 실시간 시스템은 종종 반응형 시스템으로 간주되기도 합니다. 자극이 주어지면 시스템은 지정된 시간 내에 반응 또는 반응을 생성해야 합니다.
<br>

- **주기적인 자극** (Periodic stimuli)
  - 예측 가능한 시간 간격으로 발생하는 자극
  - 예시 : 온도 센서는 초당 10회 폴링할 수 있습니다.
<br>

- **비주기적 자극** (Aperiodic stimuli)
  - 예측할 수 없는 시간에 발생하는 자극
  - 예시 : 시스템 전원 장애로 인해 시스템이 처리해야 하는 인터럽트가 트리거될 수 있습니다.
<br>

#### 도난 경보 시스템에 대한 자극과 반응
![캡처](https://i.imgur.com/ZCqeXWT.png)
<br>

### ✅ Types of stimuli (자극의 종류)
<br>

자극은 시스템 환경의 센서와 시스템에 의해 제어되는 작동기(Actuator)에서 발생합니다.
- 주기적 자극
  - 예측 가능한 시간 간격으로 발생합니다.
  - 예시
  → 시스템은 50밀리초마다 센서를 검사하고 해당 센서의 값(자극)에 따라 특정 행동(응답)을 취합니다.
<br>

- 비주기적 자극
  - 이러한 자극은 불규칙적이고 예측할 수 없이 발생하며 컴퓨터의 인터럽트 메커니즘을 사용하여 신호를 보낼 수 있습니다.
  - 예시
    → 인터럽트를 통해 I/O 전송이 완료되었으며 데이터가 버퍼에서 사용 가능함을 나타낼 수 있습니다.
<br>

#### 임베디드 실시간 시스템의 일반 모델
![캡처](https://i.imgur.com/ODsgOsl.png)

<br>

### ✅ Architectural considerations (아키텍처 고려 사항)

- 서로 다른 자극/반응에 의한 타이밍 요구에 응답해야 하기 때문에, 시스템 아키텍처는 자극 핸들러 간의 빠른 전환을 허용해야 합니다.
<br>

- 서로 다른 자극의 타이밍 요구는 다르기 떄문에 순차 루프를 통한 자극 핸들러 전환은 일반적으로 적절하지 않습니다.
<br>

- 그러므로 실시간 시스템은 일반적으로 이러한 프로세스를 제어하는 실시간 실행 개체와 협력하는 프로세스로 설계됩니다.
<br>

#### 센서 및 액추에이터 프로세스
![캡처](https://i.imgur.com/rYkBsG5.png)
<br>

#### 시스템 요소

- 센서 제어 프로세스 (Sensor control processes)
  - 센서에서 정보를 수집합니다. 센서 자극에 응답하여 수집된 정보를 버퍼링할 수 있습니다.
<br>

- 데이터 프로세서 (Data processor)
  - 수집된 정보를 처리하고 시스템 응답을 계산합니다.
<br>

- 액추에이터 제어 프로세스 (Actuator control processes)
  - 액추에이터에 대한 제어 신호를 생성합니다.
<br>

### ✅ Design process activities (설계 프로세스 활동)

- 플랫폼 선택
<br>

- 자극/반응 식별
<br>

- 타이밍 분석
<br>

- 공정설계
<br>

- 알고리즘 설계
<br>

- 데이터 설계
<br>

- 프로세스 스케줄링
<br>

### ✅ Process coordination (프로세스 조정)
<br>

- 실시간 시스템의 프로세스는 조정되고 정보를 공유해야 합니다.
<br>

- 프로세스 조정 메커니즘은 **공유 리소스에 대한 상호 배제**를 보장합니다.
<br>

- **한 프로세스가 공유 리소스를 수정할 때 다른 프로세스는 해당 리소스를 변경할 수 없습니다.**
<br>

- 프로세스 간 정보 교환을 설계할 때는 이러한 프로세스가 서로 다른 속도로 실행될 수 있다는 사실을 고려해야 합니다.
<br>

### ✅ Mutual exclusion (상호배제)
<br>

- **생산자 프로세스**는 데이터를 수집하여 버퍼에 추가합니다. **소비자 프로세스**는 버퍼에서 데이터를 가져와 요소를 사용할 수 있게 합니다.
<br>

- 생산자와 소비자 프로세스는 **동일한 요소에 액세스하는 것을 상호 배제**해야 합니다.
<br>

- 버퍼는 **생산자 프로세스가 버퍼에 정보를 가득 채우는 것**과 **소비자 프로세스가 비어 있는 버퍼에서 정보를 가져오려는 것**을 **막아야 합니다.**
<br>

#### 순환 버퍼를 공유하는 생산자/소비자 프로세스
![캡처](https://i.imgur.com/rDw7gPe.png)
<br>

### ✅ Real-time system modelling (실시간 시스템의 모델링)

- 실시간 시스템에서 자극의 효과는 한 상태에서 다른 상태로의 전환을 촉발할 수 있습니다.
<br>

- 떄문에 임베디드 실시간 시스템을 설명할 때는 상태 모델이 자주 사용됩니다.
<br>

- UML 상태 다이어그램은 실시간 시스템에서 상태 및 상태 전이를 보여주는 데 사용될 수 있습니다.
<br>

#### 셀프 주유기의 상태 기계 모델
![캡처](https://i.imgur.com/0xYTI2S.png)
<br>

#### 실시간 주유펌프 제어 시스템의 동작 순서
<br>

- 구매자는 펌프에 내장된 카드 리더기에 신용 카드를 삽입합니다.
<br>

- 카드를 제거하면 카드가 유효성 검사되는 Validating 상태로 전환됩니다.
<br>

- 카드가 유효한 경우 시스템이 펌프를 초기화하고 연료 호스를 홀스터에서 분리하면 공급 상태로 전환됩니다.
<br>

- 연료 공급이 완료되고 홀스터에서 호스가 교체되면 시스템이 Paying 상태로 전환됩니다. 
<br>

- 결제 후 펌프 소프트웨어가 대기 상태로 돌아갑니다.
<br>

### ✅ Real-time programming (실시간 프로그래밍)
<br>

- 실시간 시스템 개발을 위한 프로그래밍 언어는 **시스템 하드웨어에 접근하기 위한 기능**을 포함해야 하며, 이러한 언어로 **특정 동작의 시기를 예측할 수 있어야 합니다.**
<br>

- C와 같은 언어는 효율적인 코드를 생성할 수 있고, 자바와 같은 언어보다 시스템 레벨 언어로써 널리 사용됩니다.
<br>

- 객체 지향 시스템에서는 속성에 대한 액세스를 중재하고 운영 호출을 처리하기 위해 추가 코드가 필요하기 때문에 성능 오버헤드가 발생합니다. 때문에 객체지향 언어로는 성능 저하로 인해 실시간 마감 시간을 맞추는 것이 불가능할 수 있습니다.




